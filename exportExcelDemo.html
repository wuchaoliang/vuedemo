<!DOCTYPE html>
<html>

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title></title>
		<meta charset="utf-8" />
		<style>
			/* 此样式仅用于浏览器页面效果，Excel不会分离表格边框，不需要此样式 */
			
			table {
				border-collapse: collapse;
			}
		</style>
	</head>

	<body><!-- 设置border="1"以显示表格框线 -->
<table border="1">
  <!-- caption元素可以生成表标题，其单元格列跨度为表格的列数 -->
  <caption>生产周期报表</caption>
  <tr>
    <!-- 可以使用rowspan和colspan来合并单元格 -->
    <th rowspan="2">制单</th>
    <th rowspan="2">款号</th>
    <th rowspan="2">组别</th>
    <th colspan="2">开放数量</th>
    <th colspan="3">车间下货</th>
    <th colspan="3">车间完成</th>
    <th colspan="3">尾部入库</th>
  </tr>
  <tr>
    <th>数量</th>
    <th>日期</th>
    <th>数量</th>
    <th>日期</th>
    <th>周期</th>
    <th>数量</th>
    <th>日期</th>
    <th>周期</th>
    <th>数量</th>
    <th>日期</th>
    <th>周期</th>
  </tr>
  <tr>
    <td>制单测试</td>
    <td>款号测试</td>
    <td>组别测试</td>
    <td>开放数量-数量测试</td>
    <td>开放数量-日期测试</td>
    <td>车间下货-数量测试</td>
    <td>车间下货-日期测试</td>
    <td>车间下货-周期测试</td>
    <td>车间完成-数量测试</td>
    <td>车间完成-日期测试</td>
    <td>车间完成-周期测试</td>
    <td>尾部入库-数量测试</td>
    <td>尾部入库-日期测试</td>
    <td>尾部入库-周期测试</td>
  </tr>
  <tr>
    <td>制单测试</td>
    <td>款号测试</td>
    <td>组别测试</td>
    <td>开放数量-数量测试</td>
    <td>开放数量-日期测试</td>
    <td>车间下货-数量测试</td>
    <td>车间下货-日期测试</td>
    <td>车间下货-周期测试</td>
    <td>车间完成-数量测试</td>
    <td>车间完成-日期测试</td>
    <td>车间完成-周期测试</td>
    <td>尾部入库-数量测试</td>
    <td>尾部入库-日期测试</td>
    <td>尾部入库-周期测试</td>
  </tr>
  <tr>
    <td>制单测试</td>
    <td>款号测试</td>
    <td>组别测试</td>
    <td>开放数量-数量测试</td>
    <td>开放数量-日期测试</td>
    <td>车间下货-数量测试</td>
    <td>车间下货-日期测试</td>
    <td>车间下货-周期测试</td>
    <td>车间完成-数量测试</td>
    <td>车间完成-日期测试</td>
    <td>车间完成-周期测试</td>
    <td>尾部入库-数量测试</td>
    <td>尾部入库-日期测试</td>
    <td>尾部入库-周期测试</td>
  </tr>
  <tr>
    <td>制单测试</td>
    <td>款号测试</td>
    <td>组别测试</td>
    <td>开放数量-数量测试</td>
    <td>开放数量-日期测试</td>
    <td>车间下货-数量测试</td>
    <td>车间下货-日期测试</td>
    <td>车间下货-周期测试</td>
    <td>车间完成-数量测试</td>
    <td>车间完成-日期测试</td>
    <td>车间完成-周期测试</td>
    <td>尾部入库-数量测试</td>
    <td>尾部入库-日期测试</td>
    <td>尾部入库-周期测试</td>
  </tr>
  <tr>
    <td>制单测试</td>
    <td>款号测试</td>
    <td>组别测试</td>
    <td>开放数量-数量测试</td>
    <td>开放数量-日期测试</td>
    <td>车间下货-数量测试</td>
    <td>车间下货-日期测试</td>
    <td>车间下货-周期测试</td>
    <td>车间完成-数量测试</td>
    <td>车间完成-日期测试</td>
    <td>车间完成-周期测试</td>
    <td>尾部入库-数量测试</td>
    <td>尾部入库-日期测试</td>
    <td>尾部入库-周期测试</td>
  </tr>
  <tr>
    <td>制单测试</td>
    <td>款号测试</td>
    <td>组别测试</td>
    <td>开放数量-数量测试</td>
    <td>开放数量-日期测试</td>
    <td>车间下货-数量测试</td>
    <td>车间下货-日期测试</td>
    <td>车间下货-周期测试</td>
    <td>车间完成-数量测试</td>
    <td>车间完成-日期测试</td>
    <td>车间完成-周期测试</td>
    <td>尾部入库-数量测试</td>
    <td>尾部入库-日期测试</td>
    <td>尾部入库-周期测试</td>
  </tr>
</table>

		<a>导出表格</a>

		<script>
		var str = '<table border="1">'
			+'<caption>生产周期报表</caption>'
			+'<tr>'
				+'<th rowspan="2">制单</th>'
				+'<th rowspan="2">款号</th>'
				+'<th rowspan="2">组别</th>'
				+'<th colspan="2">开款数量</th>'
				+'<th colspan="3">车间下货</th>'
				+'<th colspan="3">车间完成</th>'
				+'<th colspan="3">尾部入库</th>'
			+'</tr>'
			+'<tr>'
				+'<th>数量</th>'
				+'<th>日期</th>'
				+'<th>数量</th>'
				+'<th>日期</th>'
				+'<th>周期</th>'
				+'<th>数量</th>'
				+'<th>日期</th>'
				+'<th>周期</th>'
				+'<th>数量</th>'
				+'<th>日期</th>'
				+'<th>周期</th>'
			+'</tr>'
			+'<tr>'
				+'<td>制单测试</td>'
				+'<td>款号测试</td>'
				+'<td>组别测试</td>'
				+'<td>开放数量-数量测试</td>'
				+'<td>开放数量-日期测试</td>'
				+'<td>车间下货-数量测试</td>'
				+'<td>车间下货-日期测试</td>'
				+'<td>车间下货-周期测试</td>'
				+'<td>车间完成-数量测试</td>'
				+'<td>车间完成-日期测试</td>'
				+'<td>车间完成-周期测试</td>'
				+'<td>尾部入库-数量测试</td>'
				+'<td>尾部入库-日期测试</td>'
				+'<td>尾部入库-周期测试</td>'
			+'</tr>'
			+'<tr>'
				+'<td>制单测试</td>'
				+'<td>款号测试</td>'
				+'<td>组别测试</td>'
				+'<td>开放数量-数量测试</td>'
				+'<td>开放数量-日期测试</td>'
				+'<td>车间下货-数量测试</td>'
				+'<td>车间下货-日期测试</td>'
				+'<td>车间下货-周期测试</td>'
				+'<td>车间完成-数量测试</td>'
				+'<td>车间完成-日期测试</td>'
				+'<td>车间完成-周期测试</td>'
				+'<td>尾部入库-数量测试</td>'
				+'<td>尾部入库-日期测试</td>'
				+'<td>尾部入库-周期测试</td>'
			+'</tr>'
			+'<tr>'
				+'<td>制单测试</td>'
				+'<td>款号测试</td>'
				+'<td>组别测试</td>'
				+'<td>开放数量-数量测试</td>'
				+'<td>开放数量-日期测试</td>'
				+'<td>车间下货-数量测试</td>'
				+'<td>车间下货-日期测试</td>'
				+'<td>车间下货-周期测试</td>'
				+'<td>车间完成-数量测试</td>'
				+'<td>车间完成-日期测试</td>'
				+'<td>车间完成-周期测试</td>'
				+'<td>尾部入库-数量测试</td>'
				+'<td>尾部入库-日期测试</td>'
				+'<td>尾部入库-周期测试</td>'
			+'</tr>'
			+'<tr>'
				+'<td>制单测试</td>'
				+'<td>款号测试</td>'
				+'<td>组别测试</td>'
				+'<td>开放数量-数量测试</td>'
				+'<td>开放数量-日期测试</td>'
				+'<td>车间下货-数量测试</td>'
				+'<td>车间下货-日期测试</td>'
				+'<td>车间下货-周期测试</td>'
				+'<td>车间完成-数量测试</td>'
				+'<td>车间完成-日期测试</td>'
				+'<td>车间完成-周期测试</td>'
				+'<td>尾部入库-数量测试</td>'
				+'<td>尾部入库-日期测试</td>'
				+'<td>尾部入库-周期测试</td>'
			+'</tr>'
			+'<tr>'
				+'<td>制单测试</td>'
				+'<td>款号测试</td>'
				+'<td>组别测试</td>'
				+'<td>开放数量-数量测试</td>'
				+'<td>开放数量-日期测试</td>'
				+'<td>车间下货-数量测试</td>'
				+'<td>车间下货-日期测试</td>'
				+'<td>车间下货-周期测试</td>'
				+'<td>车间完成-数量测试</td>'
				+'<td>车间完成-日期测试</td>'
				+'<td>车间完成-周期测试</td>'
				+'<td>尾部入库-数量测试</td>'
				+'<td>尾部入库-日期测试</td>'
				+'<td>尾部入库-周期测试</td>'
			+'</tr>'
			+'<tr>'
				+'<td>制单测试</td>'
				+'<td>款号测试</td>'
				+'<td>组别测试</td>'
				+'<td>开放数量-数量测试11</td>'
				+'<td>开放数量-日期测试1</td>'
				+'<td>车间下货-数量测试1</td>'
				+'<td>车间下货-日期测试1</td>'
				+'<td>车间下货-周期测试1</td>'
				+'<td>车间完成-数量测试1</td>'
				+'<td>车间完成-日期测试1</td>'
				+'<td>车间完成-周期测试1</td>'
				+'<td>尾部入库-数量测试1</td>'
				+'<td>尾部入库-日期测试1</td>'
				+'<td>尾部入库-周期测试1</td>'
			+'</tr>'
		+'</table>';
			// 使用outerHTML属性获取整个table元素的HTML代码（包括<table>标签），然后包装成一个完整的HTML文档，设置charset为urf-8以防止中文乱码
			var html = "<html><head><meta charset='utf-8' /></head><body>" + str+str+ "</body></html>";
			// 实例化一个Blob对象，其构造函数的第一个参数是包含文件内容的数组，第二个参数是包含文件类型属性的对象
			var blob = new Blob([html], {
				type: "application/vnd.ms-excel"
			});
			var a = document.getElementsByTagName("a")[0];
			// 利用URL.createObjectURL()方法为a元素生成blob URL
			a.href = URL.createObjectURL(blob);
			// 设置文件名，目前只有Chrome和FireFox支持此属性
			a.download = "学生成绩表.xls";
		</script>
	</body>

</html>